{"version":3,"sources":["day8/re_frame_10x.cljs"],"mappings":"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","names":["js/goog.define","day8.re-frame-10x/debug?","day8.re-frame-10x/init-tracing!","day8.reagent.impl.component/patch-custom-wrapper","day8.reagent.impl.component/patch-wrap-funs","day8.reagent.impl.batching/patch-next-tick","day8.re-frame-10x/resizer-style","draggable-area","day8.re-frame-10x/ease-transition","day8.re-frame-10x/devtools-outer","opts","position","day8.re_frame_10x.inlined_deps.reagent.v1v0v0.reagent.core.atom","panel-width%","day8.re_frame_10x.inlined_deps.re_frame.v1v1v2.re_frame.core.subscribe","showing?","dragging?","pin-to-bottom?","selected-tab","window-width","js/window.innerWidth","handle-window-resize","day8.re-frame-10x.inlined-deps.re-frame.v1v1v2.re-frame.core/dispatch","e","window-width-val","cljs.core/reset!","handle-keys","tag-name","entering-input?","cljs.core/contains?","and__4251__auto__","cljs.core._EQ_","handle-mousemove","cljs.core/deref","x","y","new-window-width","width%","handle-mouse-up","day8.re_frame_10x.inlined_deps.reagent.v1v0v0.reagent.core.create_class","js/window.addEventListener","js/window.removeEventListener","left","transition","day8.re-frame-10x.utils.re-com/box","day8.re-frame-10x.utils.re-com/h-box","day8.re-frame-10x.view.container/devtools-inner","day8.re-frame-10x/panel-div","id","panel","js/document","new-panel","js/window.focus","day8.re-frame-10x/inject-devtools!","day8.re-frame-10x.styles/inject-trace-styles","day8.re_frame_10x.inlined_deps.reagent.v1v0v0.reagent.dom.render","day8.re-frame-10x/traced-result","trace-id","fragment-id","trace","cljs.core/first","p1__21233#","cljs.core.filter","cljs.core.get_in","day8.re-frame-10x.inlined-deps.re-frame.v1v1v2.re-frame.db/app-db","day8.re-frame-10x/init-db!","day8.re-frame-10x.db/init-db","day8.re-frame-10x/factory-reset!","day8.re-frame-10x/show-panel!","show-panel?"],"sourcesContent":["(ns day8.re-frame-10x\n  (:require [day8.re-frame-10x.utils.re-com :as rc]\n            [day8.re-frame-10x.styles :as styles]\n            [day8.re-frame-10x.view.container :as container]\n            [day8.re-frame-10x.subs]\n            [day8.re-frame-10x.events]\n            [day8.re-frame-10x.db :as trace.db]\n            [day8.reagent.impl.component :refer [patch-wrap-funs patch-custom-wrapper]]\n            [day8.reagent.impl.batching :refer [patch-next-tick]]\n            [day8.re-frame-10x.inlined-deps.re-frame.v1v1v2.re-frame.core :as rf]\n            [day8.re-frame-10x.inlined-deps.reagent.v1v0v0.reagent.core :as r]\n            [day8.re-frame-10x.inlined-deps.reagent.v1v0v0.reagent.dom :as rdom]))\n\n(goog-define debug? false)\n\n#_(defonce real-schedule reagent.impl.batching/schedule)\n#_(defonce do-after-render-trace-scheduled? (atom false))\n\n(defn init-tracing!\n  \"Sets up any initial state that needs to be there for tracing. Does not enable tracing.\"\n  []\n  (patch-custom-wrapper)\n  (patch-wrap-funs)\n  (patch-next-tick))\n\n\n(defn resizer-style [draggable-area]\n  {:position \"absolute\" :z-index 2 :opacity 0\n   :left     (str (- (/ draggable-area 2)) \"px\") :width \"10px\" :height \"100%\" :top \"0px\" :cursor \"col-resize\"})\n\n(def ease-transition \"left 0.2s ease-out, top 0.2s ease-out, width 0.2s ease-out, height 0.2s ease-out\")\n\n(defn devtools-outer [opts]\n  ;; Add clear button\n  ;; Filter out different trace types\n  (let [position             (r/atom :right)\n        panel-width%         (rf/subscribe [:settings/panel-width%])\n        showing?             (rf/subscribe [:settings/show-panel?])\n        dragging?            (r/atom false)\n        pin-to-bottom?       (r/atom true)\n        selected-tab         (rf/subscribe [:settings/selected-tab])\n        window-width         (r/atom js/window.innerWidth)\n        handle-window-resize (do (rf/dispatch [:settings/window-width js/window.innerWidth]) ;; Set initial\n                                 (fn [e]\n                                   ;; N.B. I don't think this should be a perf bottleneck.\n                                   (let [window-width-val js/window.innerWidth]\n                                     (rf/dispatch [:settings/window-width window-width-val])\n                                     (reset! window-width window-width-val))))\n        handle-keys          (fn [e]\n                               (let [tag-name        (.-tagName (.-target e))\n                                     entering-input? (contains? #{\"INPUT\" \"SELECT\" \"TEXTAREA\"} tag-name)]\n                                 (when (and (not entering-input?)\n                                            (= (.-key e) \"h\")\n                                            (.-ctrlKey e))\n                                   (rf/dispatch [:settings/user-toggle-panel])\n                                   (.preventDefault e))))\n        handle-mousemove     (fn [e]\n                               (when @dragging?\n                                 (let [x                (.-clientX e)\n                                       y                (.-clientY e)\n                                       new-window-width js/window.innerWidth]\n                                   (.preventDefault e)\n                                   (let [width% (/ (- new-window-width x) new-window-width)]\n                                     (when (<= width% 0.9)\n                                       (rf/dispatch [:settings/panel-width% width%])))\n                                   (reset! window-width new-window-width))))\n        handle-mouse-up      (fn [e] (reset! dragging? false))]\n    (r/create-class\n      {:component-did-mount    (fn []\n                                 (js/window.addEventListener \"keydown\" handle-keys)\n                                 (js/window.addEventListener \"mousemove\" handle-mousemove)\n                                 (js/window.addEventListener \"mouseup\" handle-mouse-up)\n                                 (js/window.addEventListener \"resize\" handle-window-resize))\n       :component-will-unmount (fn []\n                                 (js/window.removeEventListener \"keydown\" handle-keys)\n                                 (js/window.removeEventListener \"mousemove\" handle-mousemove)\n                                 (js/window.removeEventListener \"mouseup\" handle-mouse-up)\n                                 (js/window.removeEventListener \"resize\" handle-window-resize))\n       :display-name           \"devtools outer\"\n       :reagent-render         (fn []\n                                 (let [draggable-area 10\n                                       left           (if @showing? (str (* 100 (- 1 @panel-width%)) \"%\")\n                                                                    (str @window-width \"px\"))\n                                       transition     (if @dragging?\n                                                        \"\"\n                                                        ease-transition)]\n                                   [rc/box\n                                    :class \"panel-wrapper\"\n                                    :width \"0px\"\n                                    :height \"0px\"\n                                    :style {:position \"fixed\"\n                                            :top      \"0px\"\n                                            :left     \"0px\"\n                                            :z-index  99999999}\n                                    :child [rc/h-box\n                                            :class \"panel\"\n                                            :width (str (* 100 @panel-width%) \"%\")\n                                            :height \"100%\"\n                                            :style {:position   \"fixed\"\n                                                    :z-index    1\n                                                    :box-shadow \"rgba(0, 0, 0, 0.3) 0px 0px 4px\"\n                                                    :background \"white\"\n                                                    :left       left\n                                                    :top        \"0px\"\n                                                    :transition transition}\n                                            :children [[:div.panel-resizer (when @showing? {:style         (resizer-style draggable-area)\n                                                                                            :on-mouse-down #(reset! dragging? true)})]\n                                                       [container/devtools-inner opts]]]]))})))\n\n\n(defn panel-div []\n  (let [id    \"--re-frame-10x--\"\n        panel (.getElementById js/document id)]\n    (if panel\n      panel\n      (let [new-panel (.createElement js/document \"div\")]\n        (.setAttribute new-panel \"id\" id)\n        (.appendChild (.-body js/document) new-panel)\n        (js/window.focus new-panel)\n        new-panel))))\n\n(defn inject-devtools! []\n  (styles/inject-trace-styles js/document)\n  (rdom/render [devtools-outer {:panel-type :inline\n                                :debug?     debug?}] (panel-div)))\n\n(defn traced-result [trace-id fragment-id]\n  ;; TODO: this is not terribly efficient, figure out how to get the index of the trace directly.\n  (let [trace (first (filter #(= trace-id (:id %)) (get-in @day8.re-frame-10x.inlined-deps.re-frame.v1v1v2.re-frame.db/app-db [:traces :all-traces])))]\n    (get-in trace [:tags :code fragment-id :result])))\n\n(defn init-db! []\n  (trace.db/init-db debug?))\n\n(defn ^:export factory-reset! []\n  (rf/dispatch [:settings/factory-reset]))\n\n(defn ^:export show-panel! [show-panel?]\n  (rf/dispatch [:settings/show-panel? show-panel?]))\n"]}